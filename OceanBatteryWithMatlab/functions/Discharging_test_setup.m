function [H_loss_total_discharging, H_loss_minor_discharging, H_loss_major_discharging,...
            H_static_discharging, H_turbine, Q_turbine, V_wat_rigid_discharging, T_empty_discharging, i]=Discharging_test_setup(OB_GUI_parameters)

%% DISCHARGING MODEL
%   This model symulates the discharging phase of the Ocean Battery. It
%   calculates the flow through the turbine, the time it takes to empty the
%   bladder to a desired level and more. This desired level is not
%   always zero, the battery can also be partially discharged. At the end
%   of the symulation, the efficiency of the Ocean Battery is calculated. 

%% Clearing
% clear all;
% clc;

%% Setting parameters
OB_parameters;

%% Initial calculations
startup_steps = (1/Delta_t)*t_open_ball_valve; %[-] Number of iterations that passes while the ball valve opens up.
A_turbine = (pi * (0.5*D_turbine)^2)*3; 
Interp_steps = (1/Delta_t)+1; %Calculates the amount of points used during interpolation. 

%% Model initialization
i = 1;
V_wat_rigid_discharging(1) = 0;
Q_turbine_a(1) = 3.5e-4;
V_tank(1) = V_tank_start;

%% Calculation of the starting flow
%   The behaviour of the system during the first "t_open_ball_valve" 
%   seconds of operation is calculated. "t_open_ball_valve" seconds is the 
%   time required to open the ball valve. When the ball valve is fully 
%   opened, the "startup-phase" is completed. The flow (Q_turbine) after 12
%   seconds will be used to model this phase. The startup is assumed to be
%   instant in this part. 

for i = 1:startup_steps
    %[m] Major head loss of the discharging phase.
    H_loss_major_discharging(i) = Major_head_loss_discharging(Q_turbine_a(i), OB_GUI_parameters);
    
    %[m] Minor head loss of the discharging phase.
    H_loss_minor_discharging(i) = Minor_head_loss_discharging(Q_turbine_a(i), OB_GUI_parameters);
    
    %[m] Major head loss in test tubes
    H_loss_major_test(i) = Major_head_loss_test_setup(Q_turbine_a(i), OB_GUI_parameters);
    
    %[m] Minor head loss in test tubes
    H_loss_minor_test(i) = Minor_head_loss_test_setup(Q_turbine_a(i), OB_GUI_parameters);
    
    %[m] Minor head loss turbine unit
    H_loss_turbine_unit(i) = Turbine_unit_loss(Q_turbine_a(i));    
    
    %[m] Total head loss of the discharging phase.
    H_loss_total_discharging(i) = H_loss_major_discharging(i)  + H_loss_minor_discharging(i) + H_loss_major_test(i) + H_loss_minor_test(i) + H_loss_turbine_unit(i);
    
    %[m^3] Volume of water present in the tank.
    V_tank(i+1) = V_tank(i) - Q_turbine_a(i)*Delta_t;
    
    %[m] Water hight in the tank
    h3(i) = V_tank(i) / A_tank;
    
    if h3(i)<0
        error('ERROR: Tank is empty.');
    end
    
    %[m] "Depth" of the test setup. A drawing that elaborates on h1, h2 and
    %h3 can be found in the "validation" folder.
    Depth(i) = h1 - h2 + h3(i);        
    
    %[m] Vertical difference between the surface of the water in the rigid reservoir and the
    %surface of the body of water above the system.
    H_static_discharging(i) = Depth(i) - Water_level_rigid_reservoir(V_wat_rigid_discharging(i), D_rigid, Capacity_rigid); 
    
    if H_static_discharging(i)<H_loss_total_discharging(i)
        error('ERROR: Head loss is larger than the static head. The system will not work because of too much losses.');
    end
    
    %[m] Head on the turbine (this does not yet include the losses incurred in the turbine). 
    H_turbine(i) = H_static_discharging(i) - H_loss_total_discharging (i);
        
    %[m^3] Volume of water present in the rigid reservoir.
    V_wat_rigid_discharging(i+1) = V_wat_rigid_discharging(i) + (Q_turbine_a(i)*Delta_t);
    
    %[m^3/s] Volumetric flowrate through the turbine. 
    Q_turbine_no_interp = A_turbine * sqrt(2*g*H_turbine(i)); %[m^3/s] Calculates the volumetric flowrate 1 second after the current flowrate. 
    x = [i i+1]; %Creates vector x. This vector contains the current loop number (i) and the next interation number (i+1).
    y = [Q_turbine_a(i) Q_turbine_no_interp]; %Creates vector y. This vector contains the current flowrate and the flowrate one second later.
    t_new = linspace(i, i+1, Interp_steps); %Creates vector t_new. This vector contains a number of points (Interp_steps) between i and i+1.
    Q_turbine_interp = interp1(x,y,t_new); %Linear interpolation between the current flowrate and the flowrate one second later. The number of points is specified by t_new.
    Q_turbine_a(i+1) = Q_turbine_interp(2); %[m^3/s] Takes the second value of matrix Q_turbine_interp. This is an estimation of the flowrate Delta_t seconds after the current flowrate.  
end

%% Flow during the startup phase
%   A liniar line is plotted between 0 and the flow (Q_turbine) after 
%   "t_open_ball_valve" seconds. This represents the increasing flow due to
%   the opening of the ball valve. This "startup phase" is assumed to be 
%   linear. 
Q_turbine = linspace(0,Q_turbine_a(startup_steps),startup_steps); %[m^3/s] Linear line between 0 and Q_turbine after "t_open_ball_valve" seconds. 

%% Other parameters during startup phase
%   The other parameters during the startup phase are determined in this
%   for loop, based on the flow throught the turbine during the first 
%   "t_open_ball_valve" seconds of operation.  

for i = 1:startup_steps
    %[m] Major head loss of the discharging phase.
    H_loss_major_discharging(i) = Major_head_loss_discharging(Q_turbine(i), OB_GUI_parameters);
    
    %[m] Minor head loss of the discharging phase.
    H_loss_minor_discharging(i) = Minor_head_loss_discharging(Q_turbine(i), OB_GUI_parameters); 
    
    %[m] Major head loss in test tubes
    H_loss_major_test(i) = Major_head_loss_test_setup(Q_turbine(i), OB_GUI_parameters);
    
    %[m] Minor head loss in test tubes
    H_loss_minor_test(i) = Minor_head_loss_test_setup(Q_turbine(i), OB_GUI_parameters);
    
    %[m] Minor head loss turbine unit
    H_loss_turbine_unit(i) = Turbine_unit_loss(Q_turbine(i));      
    
    %[m] Total head loss of the discharging phase.
    H_loss_total_discharging(i) = H_loss_major_discharging(i)  + H_loss_minor_discharging(i) + H_loss_major_test(i) + H_loss_minor_test(i) +  H_loss_turbine_unit(i);
    
    %[m^3] Volume of water present in the tank.
    V_tank(i+1) = V_tank(i) - Q_turbine(i)*Delta_t;
    
    %[m] Water hight in the tank
    h3(i) = V_tank(i) / A_tank;
    
    if h3(i)<0
        error('ERROR: Tank is empty.');
    end    
    
    %[m] Vertical difference between the surface of the water in the rigid reservoir and the
    %surface of the body of water above the system.
    H_static_discharging(i) = Depth(i) - Water_level_rigid_reservoir(V_wat_rigid_discharging(i), D_rigid, Capacity_rigid); 
    
    if H_static_discharging(i)<H_loss_total_discharging(i)
        error('ERROR: Head loss is larger than the static head. The system will not work because of too much losses.');
    end
    
    %[m] Head on the turbine (this does not yet include the losses incurred in the turbine). 
    H_turbine(i) = H_static_discharging(i) - H_loss_total_discharging (i);
        
    %[m^3] Volume of water present in the rigid reservoir.
    V_wat_rigid_discharging(i+1) = V_wat_rigid_discharging(i) + (Q_turbine(i)*Delta_t);  
end



%% While loop
while  V_wat_rigid_discharging(i) < V_wat_rigid_end 
       
    %[m] Major head loss of the discharging phase
    H_loss_major_discharging(i) = Major_head_loss_discharging(Q_turbine(i), OB_GUI_parameters);
    
    %[m] Minor head loss of the discharging phase
    H_loss_minor_discharging(i) = Minor_head_loss_discharging(Q_turbine(i), OB_GUI_parameters); 
    
    %[m] Major head loss in test tubes
    H_loss_major_test(i) = Major_head_loss_test_setup(Q_turbine(i), OB_GUI_parameters);
    
    %[m] Minor head loss in test tubes
    H_loss_minor_test(i) = Minor_head_loss_test_setup(Q_turbine(i), OB_GUI_parameters);
    
    %[m] Minor head loss turbine unit
    H_loss_turbine_unit(i) = Turbine_unit_loss(Q_turbine(i));
    
    %[m]Total head loss of the discharging phase
    H_loss_total_discharging(i) = H_loss_major_discharging(i) + H_loss_minor_discharging(i) + H_loss_major_test(i) + H_loss_minor_test(i) + H_loss_turbine_unit(i);
    
    %[m^3] Volume of water present in the tank.
    V_tank(i+1) = V_tank(i) - Q_turbine(i)*Delta_t;
    
    %[m] Water hight in the tank
    h3(i) = V_tank(i) / A_tank;
    
    if h3(i)<0
        error('ERROR: Tank is empty.');
    end
    
    %[m] "Depth" of the test setup. A drawing that elaborates on h1, h2 and
    %h3 can be found in the "validation" folder.
    Depth(i) = h1 - h2 + h3(i);    
    
    %[m] Vertical difference between the water surface of rigid reservoir and the water
    %surface of the body of water above the system
    H_static_discharging(i) = Depth(i) - Water_level_rigid_reservoir(V_wat_rigid_discharging(i), D_rigid, Capacity_rigid); 
   
    %[m] Head on the turbine (this does not yet include the losses incurred in the turbine) 
    H_turbine(i) = H_static_discharging(i) - H_loss_total_discharging (i);
    
    if H_static_discharging(i)<H_loss_total_discharging(i)
        error('ERROR: Head loss is larger than the static head. The system will not work because of too much losses. This issue can probably be solved by using a smaller timestep.');
    end 
        
    %[m^3] Volume of water present in the rigid reservoir.
    V_wat_rigid_discharging(i+1) = V_wat_rigid_discharging(i) + (Q_turbine(i)*Delta_t);
        
    %[m^3/s] Volumetric flowrate through the turbine. 
    Q_turbine_no_interp = A_turbine * sqrt(2*g*H_turbine(i)); %Calculates the volumetric flowrate 1 second after the current flowrate. 
    x = [i i+1]; %creates a vector with a difference of 1.
    y = [Q_turbine(i) Q_turbine_no_interp]; %Creates a vector that displays the difference between the current flowrate and the flowrate 1 second later in time.
    t_new = linspace(i, i+1, Interp_steps); %Creates a number of points between i and i+1. This determines the accuracy of the model. 
    Q_turbine_interp = interp1(x,y,t_new); %Calculates the values that lay between the "old" flow and the flow 1 second later in time. Linear interpolation. 
    Q_turbine(i+1) = Q_turbine_interp(2); %Takes the second value of the matrix with interpolated values. In this manner, the flowrate 1/stepSize seconds after the current flowrate is approximated.  

%second step in time    
i = i+1;
end

%% Output variables
T_empty_discharging = i*Delta_t; %[s] Time it takes to discharge the battery
T_empty_discharging_min = T_empty_discharging/60; %[min] Time it takes to discharge the battery

Q_turbine_ls = Q_turbine.*1000;
Q_turbine_lm = Q_turbine_ls.*60;

%% Plots 
x_for_plot_1 = 1:i;
x_for_plot_2 = 1:i;
x_for_plot_3 = 1:startup_steps+1;

figure(1)
plot(Q_turbine)
title('Flow through the turbine (Discharging)')
xlabel('Time [centi-seconds]')
ylabel('Volumetric flowrate [m^3/s]')

figure(2)
plot(x_for_plot_1, V_wat_rigid_discharging, x_for_plot_1, V_tank)
title('Volume of fluid present in the rr and tank')
xlabel('Time [centi-seconds]')
ylabel('Volume [m^3]')
legend('Volume rr','Volume tank')

x_for_plot = 1:i-1;

figure(3)
plot(x_for_plot, H_loss_total_discharging, x_for_plot, H_loss_minor_discharging, x_for_plot, H_loss_major_discharging, x_for_plot, H_loss_major_test, x_for_plot, H_loss_minor_test, x_for_plot, H_loss_turbine_unit)
title('Head loss (Discharging)')
xlabel('Time [centi-seconds]')
ylabel('Head loss [m]')
legend('Total head loss','Minor head loss','Major head loss','Major head loss (test tubes)','Minor head loss (test tubes)','Turbine unit loss')

figure(4)
plot(x_for_plot, H_static_discharging, x_for_plot, H_loss_total_discharging, x_for_plot, H_turbine)
title('Static head (Discharging)')
xlabel('Time [centi-seconds]')
ylabel('Head [m]')
legend('Static head','Total head loss','Turbine head')

figure(5)
plot(h3)
title('Water hight tank')
xlabel('Time')
ylabel('Water hight')

figure(6)
plot(Q_turbine_lm)
title('Flow through turbine [l/m]')
xlabel('Time')
ylabel('Flow [l/m]')

Emp_data_flow = [0,1.40000000000000e-05,0.000112333333333333,0.000239000000000000,0.000270000000000000,0.000302166666666667,0.000316333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000330333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000321333333333333,0.000321333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000344333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000344333333333333,0.000344333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000344333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000323333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000337333333333333,0.000330333333333333,0.000330333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000330333333333333,0.000323333333333333,0.000330333333333333,0.000323333333333333,0.000323333333333333,0.000323333333333333,0.000316333333333333,0.000309333333333333,0.000270000000000000,0.000140500000000000,2.80000000000000e-05,0];
idx_emp = 1:length(Emp_data_flow);
idx_emp_new = 1:Delta_t:length(Emp_data_flow);
Emp_data_new = interp1(idx_emp,Emp_data_flow,idx_emp_new); 
X_data = 1:length(Emp_data_new);

figure(7)
plot(X_data, Emp_data_new, x_for_plot_2,Q_turbine);
title('Flow through the turbine (Discharging)')
xlabel('Time [centi-seconds]')
ylabel('Volumetric flowrate [m^3/s]')
legend('Empirical data','Model data')
grid on

Emp_data_volume = [0,0.318518518518518,0.637037037037036,0.955555555555554,1.27407407407407,1.59259259259259,1.91111111111111,2.22962962962963,2.54814814814814,2.86666666666666,3.18518518518518,3.50370370370370,3.82222222222222,4.14074074074073,4.45925925925925,4.77777777777777,5.09629629629629,5.41481481481481,5.73333333333332,6.05185185185184,6.37037037037036,6.68888888888888,7.00740740740740,7.32592592592591,7.64444444444443,7.96296296296295,8.28148148148147,8.59999999999999,8.94133333333332,9.28266666666665,9.62399999999999,9.96533333333332,10.3066666666667,10.6480000000000,10.9893333333333,11.3306666666667,11.6720000000000,12.0133333333333,12.3546666666667,12.6960000000000,13.0373333333333,13.3786666666667,13.7200000000000,14.0613333333333,14.4026666666667,14.7440000000000,15.0853333333333,15.4266666666667,15.7680000000000,16.1093333333333,16.4506666666667,16.7920000000000,17.1333333333333,17.4746666666667,17.8160000000000,18.1573333333333,18.4986666666667,18.8400000000000,19.1783333333333,19.5166666666667,19.8550000000000,20.1933333333333,20.5316666666667,20.8700000000000,21.2083333333333,21.5466666666667,21.8850000000000,22.2233333333333,22.5616666666667,22.9000000000000,23.2383333333333,23.5766666666667,23.9150000000000,24.2533333333333,24.5916666666667,24.9300000000000,25.2683333333333,25.6066666666667,25.9450000000000,26.2833333333333,26.6216666666667,26.9600000000000,27.2983333333333,27.6366666666667,27.9750000000000,28.3133333333333,28.6516666666667,28.9900000000000,29.3283333333333,29.6666666666667,30.0050000000000,30.3433333333333,30.6816666666667,31.0200000000000,31.3583333333333,31.6966666666667,32.0350000000000,32.3733333333333,32.7116666666667,33.0500000000000,33.3883333333333,33.7266666666667,34.0650000000000,34.4033333333333,34.7416666666667,35.0800000000000,35.4183333333333,35.7566666666667,36.0950000000000,36.4333333333333,36.7716666666667,37.1100000000000,37.4483333333333,37.7866666666667,38.1250000000000,38.4633333333333,38.8016666666667,39.1400000000000,39.4793333333334,39.8186666666667,40.1580000000000,40.4973333333333,40.8366666666667,41.1760000000000,41.5153333333333,41.8546666666667,42.1940000000000,42.5333333333333,42.8726666666667,43.2120000000000,43.5513333333333,43.8906666666667,44.2300000000000,44.5693333333333,44.9086666666667,45.2480000000000,45.5873333333333,45.9266666666667,46.2660000000000,46.6053333333333,46.9446666666667,47.2840000000000,47.6233333333333,47.9626666666667,48.3020000000000,48.6413333333333,48.9806666666667,49.3200000000000,49.6573333333333,49.9946666666667,50.3320000000000,50.6693333333333,51.0066666666667,51.3440000000000,51.6813333333333,52.0186666666667,52.3560000000000,52.6933333333333,53.0306666666667,53.3680000000000,53.7053333333333,54.0426666666667,54.3800000000000,54.7173333333333,55.0546666666667,55.3920000000000,55.7293333333333,56.0666666666667,56.4040000000000,56.7413333333333,57.0786666666667,57.4160000000000,57.7533333333333,58.0906666666667,58.4280000000000,58.7653333333333,59.1026666666667,59.4400000000000,59.7793333333333,60.1186666666667,60.4580000000000,60.7973333333333,61.1366666666667,61.4760000000000,61.8153333333333,62.1546666666667,62.4940000000000,62.8333333333333,63.1726666666667,63.5120000000000,63.8513333333333,64.1906666666667,64.5300000000000,64.8693333333333,65.2086666666667,65.5480000000000,65.8873333333333,66.2266666666667,66.5660000000000,66.9053333333334,67.2446666666667,67.5840000000000,67.9233333333334,68.2626666666667,68.6020000000000,68.9413333333334,69.2806666666667,69.6200000000000,69.9586666666667,70.2973333333334,70.6360000000000,70.9746666666667,71.3133333333334,71.6520000000000,71.9906666666667,72.3293333333334,72.6680000000000,73.0066666666667,73.3453333333333,73.6840000000000,74.0226666666667,74.3613333333334,74.7000000000000,75.0386666666667,75.3773333333333,75.7160000000000,76.0546666666667,76.3933333333334,76.7320000000000,77.0706666666667,77.4093333333333,77.7480000000000,78.0866666666667,78.4253333333333,78.7640000000000,79.1026666666667,79.4413333333333,79.7800000000000,80.1183333333333,80.4566666666667,80.7950000000000,81.1333333333333,81.4716666666667,81.8100000000000,82.1483333333333,82.4866666666667,82.8250000000000,83.1633333333333,83.5016666666667,83.8400000000000,84.1783333333333,84.5166666666667,84.8550000000000,85.1933333333333,85.5316666666667,85.8700000000000,86.2083333333333,86.5466666666667,86.8850000000000,87.2233333333333,87.5616666666667,87.9000000000000,88.2383333333333,88.5766666666667,88.9150000000000,89.2533333333334,89.5916666666667,89.9300000000000,90.2693333333334,90.6086666666667,90.9480000000000,91.2873333333334,91.6266666666667,91.9660000000000,92.3053333333334,92.6446666666667,92.9840000000000,93.3233333333334,93.6626666666667,94.0020000000000,94.3413333333334,94.6806666666667,95.0200000000000,95.3593333333334,95.6986666666667,96.0380000000000,96.3773333333334,96.7166666666667,97.0560000000000,97.3953333333333,97.7346666666667,98.0740000000000,98.4133333333333,98.7526666666667,99.0920000000000,99.4313333333333,99.7706666666667,100.110000000000,100.446333333333,100.782666666667,101.119000000000,101.455333333333,101.791666666667,102.128000000000,102.464333333333,102.800666666667,103.137000000000,103.473333333333,103.809666666667,104.146000000000,104.482333333333,104.818666666667,105.155000000000,105.491333333333,105.827666666667,106.164000000000,106.500333333333,106.836666666667,107.173000000000,107.509333333333,107.845666666667,108.182000000000,108.518333333333,108.854666666667,109.191000000000,109.527333333333,109.863666666667,110.200000000000,110.534666666667,110.869333333333,111.204000000000,111.538666666667,111.873333333333,112.208000000000,112.542666666667,112.877333333333,113.212000000000,113.546666666667,113.881333333333,114.216000000000,114.550666666667,114.885333333333,115.220000000000,115.554666666667,115.889333333333,116.224000000000,116.558666666667,116.893333333333,117.228000000000,117.562666666667,117.897333333333,118.232000000000,118.566666666667,118.901333333333,119.236000000000,119.570666666667,119.905333333333,120.240000000000,120.578333333333,120.916666666667,121.255000000000,121.593333333333,121.931666666667,122.270000000000,122.608333333333,122.946666666667,123.285000000000,123.623333333333,123.961666666667,124.300000000000,124.638333333333,124.976666666667,125.315000000000,125.653333333333,125.991666666667,126.330000000000,126.668333333333,127.006666666667,127.345000000000,127.683333333333,128.021666666667,128.360000000000,128.698333333333,129.036666666667,129.375000000000,129.713333333333,130.051666666667,130.390000000000,130.726666666667,131.063333333333,131.400000000000,131.736666666667,132.073333333333,132.410000000000,132.746666666667,133.083333333333,133.420000000000,133.756666666667,134.093333333333,134.430000000000,134.766666666667,135.103333333333,135.440000000000,135.776666666667,136.113333333333,136.450000000000,136.786666666667,137.123333333333,137.460000000000,137.796666666667,138.133333333333,138.470000000000,138.806666666667,139.143333333333,139.480000000000,139.816666666667,140.153333333333,140.490000000000,140.826666666667,141.163333333333,141.500000000000,141.836666666667,142.173333333333,142.510000000000,142.846666666667,143.183333333333,143.520000000000,143.856666666667,144.193333333333,144.530000000000,144.866666666667,145.203333333333,145.540000000000,145.876666666667,146.213333333333,146.550000000000,146.886666666667,147.223333333333,147.560000000000,147.896666666667,148.233333333333,148.570000000000,148.906666666667,149.243333333333,149.580000000000,149.916666666667,150.253333333333,150.590000000000,150.925333333333,151.260666666667,151.596000000000,151.931333333333,152.266666666667,152.602000000000,152.937333333333,153.272666666667,153.608000000000,153.943333333333,154.278666666667,154.614000000000,154.949333333333,155.284666666667,155.620000000000,155.955333333333,156.290666666667,156.626000000000,156.961333333333,157.296666666667,157.632000000000,157.967333333333,158.302666666667,158.638000000000,158.973333333333,159.308666666667,159.644000000000,159.979333333333,160.314666666667,160.650000000000,160.984666666667,161.319333333333,161.654000000000,161.988666666667,162.323333333333,162.658000000000,162.992666666667,163.327333333333,163.662000000000,163.996666666667,164.331333333333,164.666000000000,165.000666666667,165.335333333333,165.670000000000,166.004666666667,166.339333333333,166.674000000000,167.008666666667,167.343333333333,167.678000000000,168.012666666667,168.347333333333,168.682000000000,169.016666666667,169.351333333333,169.686000000000,170.020666666667,170.355333333333,170.690000000000,171.025666666667,171.361333333333,171.697000000000,172.032666666667,172.368333333333,172.704000000000,173.039666666667,173.375333333333,173.711000000000,174.046666666667,174.382333333333,174.718000000000,175.053666666667,175.389333333333,175.725000000000,176.060666666667,176.396333333333,176.732000000000,177.067666666667,177.403333333333,177.739000000000,178.074666666667,178.410333333333,178.746000000000,179.081666666667,179.417333333333,179.753000000000,180.088666666667,180.424333333333,180.760000000000,181.094666666667,181.429333333333,181.764000000000,182.098666666667,182.433333333333,182.768000000000,183.102666666667,183.437333333333,183.772000000000,184.106666666667,184.441333333333,184.776000000000,185.110666666667,185.445333333333,185.780000000000,186.114666666667,186.449333333333,186.784000000000,187.118666666667,187.453333333333,187.788000000000,188.122666666667,188.457333333333,188.792000000000,189.126666666667,189.461333333333,189.796000000000,190.130666666667,190.465333333333,190.800000000000,191.133666666667,191.467333333333,191.801000000000,192.134666666667,192.468333333333,192.802000000000,193.135666666667,193.469333333333,193.803000000000,194.136666666667,194.470333333333,194.804000000000,195.137666666667,195.471333333333,195.805000000000,196.138666666667,196.472333333333,196.806000000000,197.139666666667,197.473333333333,197.807000000000,198.140666666667,198.474333333333,198.808000000000,199.141666666667,199.475333333333,199.809000000000,200.142666666667,200.476333333333,200.810000000000,201.142666666667,201.475333333333,201.808000000000,202.140666666667,202.473333333333,202.806000000000,203.138666666667,203.471333333333,203.804000000000,204.136666666667,204.469333333333,204.802000000000,205.134666666667,205.467333333333,205.800000000000,206.132666666667,206.465333333333,206.798000000000,207.130666666667,207.463333333333,207.796000000000,208.128666666667,208.461333333333,208.794000000000,209.126666666667,209.459333333333,209.792000000000,210.124666666667,210.457333333333,210.790000000000,211.121000000000,211.452000000000,211.783000000000,212.114000000000,212.445000000000,212.776000000000,213.107000000000,213.438000000000,213.769000000000,214.100000000000,214.431000000000,214.762000000000,215.093000000000,215.424000000000,215.755000000000,216.086000000000,216.417000000000,216.748000000000,217.079000000000,217.410000000000,217.741000000000,218.072000000000,218.403000000000,218.734000000000,219.065000000000,219.396000000000,219.727000000000,220.058000000000,220.389000000000,220.720000000000,221.052666666667,221.385333333333,221.718000000000,222.050666666667,222.383333333333,222.716000000000,223.048666666667,223.381333333333,223.714000000000,224.046666666667,224.379333333333,224.712000000000,225.044666666667,225.377333333333,225.710000000000,226.042666666667,226.375333333333,226.708000000000,227.040666666667,227.373333333333,227.706000000000,228.038666666667,228.371333333333,228.704000000000,229.036666666667,229.369333333333,229.702000000000,230.034666666667,230.367333333333,230.700000000000,231.032000000000,231.364000000000,231.696000000000,232.028000000000,232.360000000000,232.692000000000,233.024000000000,233.356000000000,233.688000000000,234.020000000000,234.352000000000,234.684000000000,235.016000000000,235.348000000000,235.680000000000,236.012000000000,236.344000000000,236.676000000000,237.008000000000,237.340000000000,237.672000000000,238.004000000000,238.336000000000,238.668000000000,239,239.332000000000,239.664000000000,239.996000000000,240.328000000000,240.660000000000,240.991666666667,241.323333333333,241.655000000000,241.986666666667,242.318333333333,242.650000000000,242.981666666667,243.313333333333,243.645000000000,243.976666666667,244.308333333333,244.640000000000,244.971666666667,245.303333333333,245.635000000000,245.966666666667,246.298333333333,246.630000000000,246.961666666667,247.293333333333,247.625000000000,247.956666666667,248.288333333333,248.620000000000,248.951666666667,249.283333333333,249.615000000000,249.946666666667,250.278333333333,250.610000000000,250.941000000000,251.272000000000,251.603000000000,251.934000000000,252.265000000000,252.596000000000,252.927000000000,253.258000000000,253.589000000000,253.920000000000,254.251000000000,254.582000000000,254.913000000000,255.244000000000,255.575000000000,255.906000000000,256.237000000000,256.568000000000,256.899000000000,257.230000000000,257.561000000000,257.892000000000,258.223000000000,258.554000000000,258.885000000000,259.216000000000,259.547000000000,259.878000000000,260.209000000000,260.540000000000,260.871000000000,261.202000000000,261.533000000000,261.864000000000,262.195000000000,262.526000000000,262.857000000000,263.188000000000,263.519000000000,263.850000000000,264.181000000000,264.512000000000,264.843000000000,265.174000000000,265.505000000000,265.836000000000,266.167000000000,266.498000000000,266.829000000000,267.160000000000,267.491000000000,267.822000000000,268.153000000000,268.484000000000,268.815000000000,269.146000000000,269.477000000000,269.808000000000,270.139000000000,270.470000000000,270.800666666667,271.131333333333,271.462000000000,271.792666666667,272.123333333333,272.454000000000,272.784666666667,273.115333333333,273.446000000000,273.776666666667,274.107333333333,274.438000000000,274.768666666667,275.099333333333,275.430000000000,275.760666666667,276.091333333333,276.422000000000,276.752666666667,277.083333333333,277.414000000000,277.744666666667,278.075333333333,278.406000000000,278.736666666667,279.067333333333,279.398000000000,279.728666666667,280.059333333333,280.390000000000,280.721000000000,281.052000000000,281.383000000000,281.714000000000,282.045000000000,282.376000000000,282.707000000000,283.038000000000,283.369000000000,283.700000000000,284.031000000000,284.362000000000,284.693000000000,285.024000000000,285.355000000000,285.686000000000,286.017000000000,286.348000000000,286.679000000000,287.010000000000,287.341000000000,287.672000000000,288.003000000000,288.334000000000,288.665000000000,288.996000000000,289.327000000000,289.658000000000,289.989000000000,290.320000000000,290.648000000000,290.976000000000,291.304000000000,291.632000000000,291.960000000000,292.288000000000,292.616000000000,292.944000000000,293.272000000000,293.600000000000,293.928000000000,294.256000000000,294.584000000000,294.912000000000,295.240000000000,295.568000000000,295.896000000000,296.224000000000,296.552000000000,296.880000000000,297.208000000000,297.536000000000,297.864000000000,298.192000000000,298.520000000000,298.848000000000,299.176000000000,299.504000000000,299.832000000000,300.160000000000,300.470000000000,300.780000000000,301.060000000000,301.230000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000,301.290000000000];
ixd_emp_volume = 1:length(Emp_data_volume);
ixd_emp_volume_new = 1:Delta_t:length(Emp_data_volume);
Emp_data_volume_new = interp1(ixd_emp_volume,Emp_data_volume,ixd_emp_volume_new);
X_data_2 = 1:length(Emp_data_volume_new);
V_wat_rigid_discharging_L = V_wat_rigid_discharging.*1000;

figure(8)
plot(X_data_2, Emp_data_volume_new, x_for_plot_1, V_wat_rigid_discharging_L);
title('Volume water rigid reservoir [m^3]')
xlabel('Time [centi-seconds]')
ylabel('Volume [m^3]')
legend('Empirical data','Model data')
grid on

end